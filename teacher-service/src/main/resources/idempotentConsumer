


@Transactional
public void handle(GradeCreatedEvent event) {

    if (processedRepository.existsById(event.getEventId())) {
        return; // уже обрабатывали
    }

    // делаем бизнес-логику
    sendEmail();

    processedRepository.save(
        new ProcessedEvent(event.getEventId())
    );
}







GradeCreatedEvent event = GradeCreatedEvent.builder()
    .eventId(UUID.randomUUID())
    .studentId(10L)
    .value(5)
    .build();






    spring:
      kafka:
        bootstrap-servers: localhost:9092
        consumer:
          group-id: notification-service
          auto-offset-reset: earliest
          enable-auto-commit: false
          key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
          value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
          properties:
            spring.json.trusted.packages: "*"